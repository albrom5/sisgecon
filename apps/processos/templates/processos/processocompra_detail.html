{% extends 'base.html' %}
{% load l10n %}

{% block title %}
{{ object.processo_id.get_tipo_display }} nº: {{ object.processo_id }}
{% endblock %}

{% block main %}

     <div class="container-fluid">
         <div class="row g-2 p-2">
              <div class="col-md">
                  <h4>{{ object.processo_id.get_tipo_display }} nº: {{ object.processo_id.numero_sei }}</h4>
              </div>
         </div>
         <div class="row g-2 p-2">
              <div class="col-md">
                  <h4>Objeto: {{ object.processo_id.descricao }}</h4>
              </div>
         </div>
         <div class="row g-2 p-2">
              <div class="col-md">
                  Status: {{ object.status }}
              </div>
              <div class="col-md">
                  Data de entrada na GCO: {{ object.data_gco|date:"SHORT_DATE_FORMAT" }}
              </div>
              <div class="col-md">
                  Modalidade: {{ object.modalidade }}
              </div>
         </div>
        <div class="row g-2 p-2"></div>
        {% for sc in object.solicitacaocompra_set.all %}
        <div class="row g-2 p-2 border-top">
            <div class="col-md">
                <button class="btn btn-toggle align-items-center rounded collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseItens" aria-expanded="false" aria-controls="collapseExample">
                      </button>
                <strong>SC: {{ sc.numsc }}</strong>
            </div>
            <div class="col-md">
                Data de emissão: {{ sc.data_emissao|date:"SHORT_DATE_FORMAT" }}
            </div>
            <div class="col-md">
                Prazo: {{ sc.prazo|date:"SHORT_DATE_FORMAT" }}
            </div>
            <div class="col-md">
                Valor total: R$ {{ sc.valor_total_sc|floatformat:2 }}
            </div>
            <div class="row g-2 p-2">
                <div class="collapse" id="collapseItens">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th scope="col">Produto</th>
                                <th scope="col">Quantidade</th>
                                <th scope="col">Valor unitário</th>
                                <th scope="col">Valor total do item</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in sc.itemsc_sc.all %}
                            <tr>
                                <td>{{ item.produto }}</td>
                                <td>{{ item.quantidade|floatformat:2 }}</td>
                                <td>R$ {{ item.valor_unit|floatformat:2 }}</td>
                                <td>R$ {{ item.valor_total|floatformat:2 }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
            {% empty %}
            <div class="row g-2 p-2">
            Processo sem SC's cadastradas.
            </div>
        {% endfor %}


        <div class="row g-2 p-2">
            <div class="col-3">
                <a href="{% url 'processo_edit' object.processo_id.id %}" class="btn btn-primary">
                    Alterar dados
                </a>
            </div>
        </div>
        <div class="row g-2 p-2">
            <div class="col-3">
                <a href="{% url 'processos_list' %}" class="btn btn-secondary">
                    Voltar para lista de processos
                </a>
            </div>
        </div>
     </div>
{% endblock %}
